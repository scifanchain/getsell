# Hocuspocus è¯¦è§£

## ğŸ“‹ ä»€ä¹ˆæ˜¯ Hocuspocusï¼Ÿ

**Hocuspocus** æ˜¯ä¸€ä¸ªåŸºäº **Yjs** çš„**ä¼ä¸šçº§å®æ—¶åä½œåç«¯æœåŠ¡å™¨**ï¼Œç”±å¾·å›½æŸæ—çš„ **Tiptap** å›¢é˜Ÿå¼€å‘å’Œç»´æŠ¤ã€‚

ç®€å•æ¥è¯´ï¼š
- ğŸ”Œ **å³æ’å³ç”¨çš„ WebSocket æœåŠ¡å™¨**
- ğŸš€ **ä¸“ä¸º Yjs åä½œä¼˜åŒ–**
- ğŸ’¼ **ä¼ä¸šçº§ç‰¹æ€§å’Œç¨³å®šæ€§**
- ğŸ¯ **æ¯”è‡ªå·±å†™ yjs-server æ›´å¯é **

---

## ğŸ’° ä»·æ ¼å’Œè®¸å¯è¯

### âœ… **å®Œå…¨å…è´¹ä¸”å¼€æºï¼**

| é¡¹ç›® | å†…å®¹ |
|------|------|
| **è®¸å¯è¯** | âœ… **MIT License** |
| **GitHub** | https://github.com/ueberdosis/hocuspocus |
| **Stars** | â­ 1.9k+ |
| **è´¹ç”¨** | ğŸ†“ **å®Œå…¨å…è´¹** |
| **å•†ä¸šä½¿ç”¨** | âœ… **å…è®¸** |
| **è‡ªæ‰˜ç®¡** | âœ… **å®Œå…¨æ”¯æŒ** |

```bash
# å®‰è£…å®Œå…¨å…è´¹
npm install @hocuspocus/server @hocuspocus/extension-database
```

**å…³é”®ç‚¹**ï¼š
- âœ… **æºä»£ç å¼€æ”¾** - MIT è®¸å¯è¯
- âœ… **æ— ä½¿ç”¨é™åˆ¶** - å¯ä»¥å•†ä¸šä½¿ç”¨
- âœ… **æ— éœ€ä»˜è´¹** - æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å…è´¹
- âœ… **è‡ªå·±éƒ¨ç½²** - å®Œå…¨æ§åˆ¶

---

## ğŸ’ Tiptap Collab Cloudï¼ˆå¯é€‰ä»˜è´¹æœåŠ¡ï¼‰

Hocuspocus å›¢é˜Ÿæä¾›**æ‰˜ç®¡æœåŠ¡**ï¼ˆ**éå¿…é¡»**ï¼‰ï¼š

### Tiptap Collab Cloud

**å®˜ç½‘**: https://tiptap.dev/collab

**è¿™æ˜¯ä»€ä¹ˆ**ï¼š
- ğŸŒ¥ï¸ å®Œå…¨æ‰˜ç®¡çš„åä½œæœåŠ¡
- ğŸš€ æ— éœ€è‡ªå·±éƒ¨ç½²æœåŠ¡å™¨
- ğŸ”§ é›¶è¿ç»´
- ğŸ“Š åŒ…å«ç›‘æ§å’Œåˆ†æ

**ä»·æ ¼**ï¼ˆ2025 å¹´ï¼‰ï¼š

| æ–¹æ¡ˆ | ä»·æ ¼ | åŒ…å«å†…å®¹ |
|------|------|---------|
| **Free** | $0/æœˆ | 10 ä¸ªæ–‡æ¡£ï¼Œ1GB å­˜å‚¨ |
| **Starter** | $29/æœˆ | 100 ä¸ªæ–‡æ¡£ï¼Œ10GB å­˜å‚¨ |
| **Pro** | $199/æœˆ | æ— é™æ–‡æ¡£ï¼Œ100GB å­˜å‚¨ |
| **Enterprise** | å®šåˆ¶ | ä¸“å±æœåŠ¡å™¨ï¼ŒSLA ä¿è¯ |

**æ³¨æ„**ï¼š
- âš ï¸ **è¿™æ˜¯å¯é€‰æœåŠ¡**ï¼Œä¸æ˜¯å¿…é¡»çš„ï¼
- âœ… **è‡ªå·±éƒ¨ç½² Hocuspocus å®Œå…¨å…è´¹**
- ğŸ’¡ **ä»…å½“ä¸æƒ³è‡ªå·±è¿ç»´æ—¶æ‰éœ€è¦**

---

## ğŸ†š Hocuspocus vs è‡ªå»º yjs-server

### å¯¹æ¯”è¡¨

| ç‰¹æ€§ | è‡ªå»º yjs-server | Hocuspocus (è‡ªæ‰˜ç®¡) | Tiptap Cloud (ä»˜è´¹) |
|------|----------------|-------------------|-------------------|
| **è´¹ç”¨** | å…è´¹ | å…è´¹ | $29-199/æœˆ |
| **æ•°æ®æŒä¹…åŒ–** | âŒ éœ€è¦è‡ªå·±å®ç° | âœ… å†…ç½®å¤šç§é€‰é¡¹ | âœ… å…¨æ‰˜ç®¡ |
| **èº«ä»½éªŒè¯** | âŒ éœ€è¦è‡ªå·±å®ç° | âœ… å†…ç½® JWT/è‡ªå®šä¹‰ | âœ… å…¨æ‰˜ç®¡ |
| **æ•°æ®åº“æ”¯æŒ** | âŒ æ—  | âœ… SQLite/PostgreSQL/MySQL | âœ… å…¨æ‰˜ç®¡ |
| **Redis é›†ç¾¤** | âŒ éœ€è¦è‡ªå·±å®ç° | âœ… å†…ç½®æ”¯æŒ | âœ… å…¨æ‰˜ç®¡ |
| **Webhook** | âŒ æ—  | âœ… å†…ç½® | âœ… å…¨æ‰˜ç®¡ |
| **ç›‘æ§æŒ‡æ ‡** | âŒ éœ€è¦è‡ªå·±å®ç° | âœ… å†…ç½® | âœ… é«˜çº§ç›‘æ§ |
| **æ–‡æ¡£å’Œæ”¯æŒ** | âš ï¸ åŸºç¡€ | âœ… å®Œæ•´ | âœ… ä¸“ä¸šæ”¯æŒ |
| **ç”Ÿäº§å°±ç»ª** | âŒ å¦ | âœ… æ˜¯ | âœ… æ˜¯ |
| **ç»´æŠ¤æˆæœ¬** | ğŸ”´ é«˜ | ğŸŸ¡ ä¸­ | ğŸŸ¢ é›¶ |

---

## âš™ï¸ Hocuspocus æ ¸å¿ƒç‰¹æ€§

### 1. **æ•°æ®æŒä¹…åŒ–**ï¼ˆå†…ç½®ï¼‰

```typescript
import { Server } from '@hocuspocus/server'
import { Database } from '@hocuspocus/extension-database'

const server = Server.configure({
  extensions: [
    new Database({
      // PostgreSQL
      fetch: async ({ documentName }) => {
        return await db.getDocument(documentName)
      },
      store: async ({ documentName, state }) => {
        await db.saveDocument(documentName, state)
      }
    })
  ]
})
```

**æ”¯æŒçš„æ•°æ®åº“**ï¼š
- âœ… SQLiteï¼ˆå†…ç½®æ‰©å±•ï¼‰
- âœ… PostgreSQL
- âœ… MySQL
- âœ… MongoDBï¼ˆç¤¾åŒºï¼‰
- âœ… è‡ªå®šä¹‰æ•°æ®åº“

### 2. **èº«ä»½éªŒè¯**ï¼ˆå†…ç½®ï¼‰

```typescript
import { Server } from '@hocuspocus/server'

const server = Server.configure({
  async onAuthenticate(data) {
    const { token, documentName, connection } = data
    
    // JWT éªŒè¯
    const user = await verifyToken(token)
    
    // æƒé™æ£€æŸ¥
    const hasAccess = await checkAccess(user.id, documentName)
    
    if (!hasAccess) {
      throw new Error('Access denied')
    }
    
    return {
      user: {
        id: user.id,
        name: user.name
      }
    }
  }
})
```

### 3. **Webhook**ï¼ˆå†…ç½®ï¼‰

```typescript
import { Webhook } from '@hocuspocus/extension-webhook'

const server = Server.configure({
  extensions: [
    new Webhook({
      url: 'https://your-api.com/webhook',
      events: ['change', 'connect', 'disconnect']
    })
  ]
})
```

### 4. **Redis é›†ç¾¤**ï¼ˆå†…ç½®ï¼‰

```typescript
import { Redis } from '@hocuspocus/extension-redis'

const server = Server.configure({
  extensions: [
    new Redis({
      host: 'localhost',
      port: 6379
    })
  ]
})
```

**æ”¯æŒ**ï¼š
- âœ… æ°´å¹³æ‰©å±•ï¼ˆå¤šä¸ª Hocuspocus å®ä¾‹ï¼‰
- âœ… è´Ÿè½½å‡è¡¡
- âœ… é«˜å¯ç”¨

### 5. **ç›‘æ§å’Œæ—¥å¿—**ï¼ˆå†…ç½®ï¼‰

```typescript
import { Logger } from '@hocuspocus/extension-logger'

const server = Server.configure({
  extensions: [
    new Logger({
      level: 'info',
      onLog: (message) => {
        // å‘é€åˆ° Sentry / DataDog ç­‰
        console.log(message)
      }
    })
  ],
  
  async onStatistics(data) {
    // æ€§èƒ½æŒ‡æ ‡
    console.log('Connections:', data.connectionsCount)
    console.log('Documents:', data.documentsCount)
  }
})
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…

```bash
npm install @hocuspocus/server @hocuspocus/extension-sqlite
```

### æœ€ç®€ç¤ºä¾‹

```typescript
// server.js
import { Server } from '@hocuspocus/server'
import { SQLite } from '@hocuspocus/extension-sqlite'

const server = Server.configure({
  port: 4001,
  
  extensions: [
    new SQLite({
      database: 'db.sqlite'
    })
  ]
})

server.listen()
```

### å®Œæ•´ç¤ºä¾‹ï¼ˆç”Ÿäº§çº§ï¼‰

```typescript
import { Server } from '@hocuspocus/server'
import { Database } from '@hocuspocus/extension-database'
import { Logger } from '@hocuspocus/extension-logger'
import { Redis } from '@hocuspocus/extension-redis'
import jwt from 'jsonwebtoken'

const server = Server.configure({
  port: 4001,
  
  // èº«ä»½éªŒè¯
  async onAuthenticate(data) {
    const { token } = data
    
    try {
      const decoded = jwt.verify(token, process.env.JWT_SECRET)
      return { user: decoded }
    } catch (err) {
      throw new Error('Invalid token')
    }
  },
  
  // æƒé™æ£€æŸ¥
  async onLoadDocument(data) {
    const { documentName, context } = data
    
    const hasAccess = await checkUserAccess(
      context.user.id, 
      documentName
    )
    
    if (!hasAccess) {
      throw new Error('Access denied')
    }
    
    return data.document
  },
  
  extensions: [
    // æ•°æ®åº“æŒä¹…åŒ–
    new Database({
      fetch: async ({ documentName }) => {
        return await db.getYDoc(documentName)
      },
      store: async ({ documentName, state }) => {
        await db.saveYDoc(documentName, state)
      }
    }),
    
    // Redis é›†ç¾¤
    new Redis({
      host: process.env.REDIS_HOST,
      port: 6379
    }),
    
    // æ—¥å¿—
    new Logger({
      level: 'info'
    })
  ]
})

server.listen()
```

---

## ğŸ“¦ å¯ç”¨æ‰©å±•

| æ‰©å±• | åŠŸèƒ½ | åŒ…å |
|------|------|------|
| **SQLite** | SQLite æŒä¹…åŒ– | `@hocuspocus/extension-sqlite` |
| **Database** | è‡ªå®šä¹‰æ•°æ®åº“ | `@hocuspocus/extension-database` |
| **Redis** | Redis é›†ç¾¤ | `@hocuspocus/extension-redis` |
| **Webhook** | Webhook é€šçŸ¥ | `@hocuspocus/extension-webhook` |
| **Logger** | æ—¥å¿—è®°å½• | `@hocuspocus/extension-logger` |
| **Throttle** | é€Ÿç‡é™åˆ¶ | `@hocuspocus/extension-throttle` |
| **Monitor** | æ€§èƒ½ç›‘æ§ | `@hocuspocus/extension-monitor` |

---

## ğŸ¯ é€‚åˆ Gestell é¡¹ç›®å—ï¼Ÿ

### âœ… å¼ºçƒˆæ¨èä½¿ç”¨ Hocuspocusï¼ˆè‡ªæ‰˜ç®¡ï¼‰

**ç†ç”±**ï¼š

1. **å…è´¹å¼€æº**
   - MIT è®¸å¯è¯
   - å¯ä»¥å•†ä¸šä½¿ç”¨
   - å®Œå…¨å…è´¹

2. **ç”Ÿäº§å°±ç»ª**
   - å†…ç½®æŒä¹…åŒ–
   - å†…ç½®è®¤è¯
   - å†…ç½®é”™è¯¯å¤„ç†

3. **èŠ‚çœæ—¶é—´**
   - æ— éœ€ä»å¤´å®ç°
   - å‡å°‘ 7-10 å¤©å¼€å‘æ—¶é—´
   - é¿å…ç”Ÿäº§ç¯å¢ƒè¸©å‘

4. **æ´»è·ƒç»´æŠ¤**
   - 1.9k+ GitHub Stars
   - 77+ è´¡çŒ®è€…
   - å®šæœŸæ›´æ–°

5. **æ˜“äºé›†æˆ**
   - å®Œå–„çš„æ–‡æ¡£
   - TypeScript æ”¯æŒ
   - ä¸°å¯Œçš„ç¤ºä¾‹

### å¯¹æ¯”æ–¹æ¡ˆ

| æ–¹æ¡ˆ | æˆæœ¬ | æ—¶é—´ | é£é™© | æ¨èåº¦ |
|------|------|------|------|--------|
| **å½“å‰ yjs-server** | å…è´¹ | 7-10å¤©æ”¹è¿› | é«˜ | â­â˜†â˜†â˜†â˜† |
| **Hocuspocusï¼ˆè‡ªæ‰˜ç®¡ï¼‰** | å…è´¹ | 1-2å¤©é›†æˆ | ä½ | â­â­â­â­â­ |
| **Tiptap Cloud** | $29+/æœˆ | 0.5å¤© | æ—  | â­â­â­â­â˜† |

---

## ğŸ’¡ è¿ç§»å»ºè®®

### ä»å½“å‰ yjs-server è¿ç§»åˆ° Hocuspocus

**å·¥ä½œé‡**: 1-2 å¤©

**æ­¥éª¤**ï¼š

1. **å®‰è£… Hocuspocus**
   ```bash
   cd yjs-server
   npm install @hocuspocus/server @hocuspocus/extension-sqlite
   ```

2. **æ›¿æ¢ server.js**
   ```typescript
   // æ–°çš„ server.js
   import { Server } from '@hocuspocus/server'
   import { SQLite } from '@hocuspocus/extension-sqlite'
   
   const server = Server.configure({
     port: 4001,
     extensions: [
       new SQLite({ database: 'gestell.db' })
     ]
   })
   
   server.listen()
   ```

3. **æ›´æ–°å®¢æˆ·ç«¯ï¼ˆå¯é€‰ï¼‰**
   - å®¢æˆ·ç«¯ä»£ç åŸºæœ¬ä¸éœ€è¦æ”¹
   - WebSocket URL ä¿æŒä¸å˜
   - Yjs åè®®å®Œå…¨å…¼å®¹

4. **æµ‹è¯•**
   ```bash
   npm run dev
   # æµ‹è¯•åä½œåŠŸèƒ½
   ```

---

## ğŸŒŸ ç¤¾åŒºå’Œæ”¯æŒ

### å®˜æ–¹èµ„æº

- **å®˜ç½‘**: https://hocuspocus.dev/
- **GitHub**: https://github.com/ueberdosis/hocuspocus
- **Discord**: https://discord.gg/WtJ49jGshW
- **æ–‡æ¡£**: https://tiptap.dev/docs/hocuspocus

### å•†ä¸šæ”¯æŒ

å¦‚æœéœ€è¦ä¸“ä¸šæ”¯æŒï¼š
- Tiptap æä¾›ä»˜è´¹æ”¯æŒè®¡åˆ’
- ä¼ä¸šçº§ SLA
- ä¼˜å…ˆåŠŸèƒ½å¼€å‘

---

## ğŸ“Š æ€»ç»“å¯¹æ¯”

### Hocuspocusï¼ˆè‡ªæ‰˜ç®¡ï¼‰vs è‡ªå»º

| ç»´åº¦ | è‡ªå»º yjs-server | Hocuspocus |
|------|----------------|-----------|
| **è´¹ç”¨** | å…è´¹ | å…è´¹ âœ… |
| **å¼€å‘æ—¶é—´** | 7-10 å¤© | 1-2 å¤© âœ… |
| **ç”Ÿäº§å°±ç»ª** | âŒ å¦ | âœ… æ˜¯ |
| **ç»´æŠ¤æˆæœ¬** | ğŸ”´ é«˜ | ğŸŸ¢ ä½ |
| **åŠŸèƒ½å®Œæ•´æ€§** | â­â­â˜†â˜†â˜† | â­â­â­â­â­ |
| **ç¤¾åŒºæ”¯æŒ** | âš ï¸ æœ‰é™ | âœ… æ´»è·ƒ |
| **æ–‡æ¡£è´¨é‡** | âš ï¸ åŸºç¡€ | âœ… å®Œå–„ |

---

## ğŸ¯ æœ€ç»ˆå»ºè®®

### å¯¹äº Gestell é¡¹ç›®

**æ¨è**: â­â­â­â­â­ **ä½¿ç”¨ Hocuspocusï¼ˆè‡ªæ‰˜ç®¡ï¼‰**

**ç†ç”±**ï¼š
1. âœ… **å®Œå…¨å…è´¹** - MIT è®¸å¯è¯
2. âœ… **èŠ‚çœæ—¶é—´** - å‡å°‘ 7-10 å¤©å¼€å‘
3. âœ… **ç”Ÿäº§å°±ç»ª** - æ— éœ€æ‹…å¿ƒæ•°æ®ä¸¢å¤±
4. âœ… **æ˜“äºç»´æŠ¤** - æ´»è·ƒçš„ç¤¾åŒºæ”¯æŒ
5. âœ… **åŠŸèƒ½å®Œæ•´** - åŒ…å«æ‰€æœ‰éœ€è¦çš„ç‰¹æ€§

**ä¸æ¨èä»˜è´¹**ï¼š
- âŒ Tiptap Cloud æ‰˜ç®¡æœåŠ¡ï¼ˆ$29+/æœˆï¼‰
- ç†ç”±ï¼šè‡ªæ‰˜ç®¡å®Œå…¨å¯ä»¥æ»¡è¶³éœ€æ±‚
- é™¤éï¼šå®Œå…¨ä¸æƒ³ç®¡ç†æœåŠ¡å™¨

### å®æ–½è®¡åˆ’

**ç¬¬ 1 æ­¥**ï¼ˆä»Šå¤©ï¼‰ï¼š
```bash
cd yjs-server
npm install @hocuspocus/server @hocuspocus/extension-sqlite
```

**ç¬¬ 2 æ­¥**ï¼ˆæ˜å¤©ï¼‰ï¼š
- æ›¿æ¢ server.js
- æµ‹è¯•åŸºæœ¬åŠŸèƒ½

**ç¬¬ 3 æ­¥**ï¼ˆåå¤©ï¼‰ï¼š
- æ·»åŠ è®¤è¯
- é…ç½®æ•°æ®åº“
- éƒ¨ç½²æµ‹è¯•

**æ€»æ—¶é—´**: **1-2 å¤©**ï¼Œè¿œå°‘äºè‡ªå·±æ”¹è¿›å½“å‰ä»£ç çš„ **7-10 å¤©**ï¼

---

## ğŸš¨ å…³é”®ç‚¹

1. **Hocuspocus æ˜¯å®Œå…¨å…è´¹çš„å¼€æºé¡¹ç›®**
2. **ä¸éœ€è¦ä»˜è´¹å°±èƒ½ä½¿ç”¨æ‰€æœ‰åŠŸèƒ½**
3. **Tiptap Cloud æ˜¯å¯é€‰çš„æ‰˜ç®¡æœåŠ¡ï¼Œéå¿…é¡»**
4. **è‡ªæ‰˜ç®¡ Hocuspocus æ˜¯æœ€ä½³é€‰æ‹©**
5. **æ¯”è‡ªå·±å†™ yjs-server æ›´å¯é ä¸”èŠ‚çœæ—¶é—´**

**ä¸è¦è¢«"ä¼ä¸šçº§"è¿™ä¸ªè¯å“åˆ°ï¼Œå®ƒæ˜¯å…è´¹çš„ï¼** ğŸ‰
